```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Art Gallery Carousel - Enhanced++</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@300;400&display=swap');

        :root {
            --background-color: #1a1a1a;
            --text-color: #e0e0e0;
            --primary-accent: #ff6b6b; /* Coral Red */
            --secondary-accent: #4ecdc4; /* Turquoise */
            --tertiary-accent: #ffe66d; /* Light Yellow - for events */
            --card-background: #2b2b2b;
            --shadow-color: rgba(0, 0, 0, 0.5);
            --nav-background: #222;
            --font-heading: 'Playfair Display', serif;
            --font-body: 'Lato', sans-serif;
            --carousel-transition-speed: 0.5s;
            --section-spacing: 4rem; /* Variable for consistent section spacing */
            --focus-outline-color: var(--secondary-accent); /* Added for focus states */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
            perspective: 1000px;
        }

        /* --- Focus Visible --- */
        :focus-visible {
            outline: 3px solid var(--focus-outline-color);
            outline-offset: 2px;
        }
        :focus:not(:focus-visible) {
            outline: none;
        }
         .carousel-button:focus-visible,
         .carousel-dot:focus-visible,
         #backToTopBtn:focus-visible,
         .event-card a:focus-visible, /* Added for event links */
         .contact-button:focus-visible,
         .lightbox-close:focus-visible,
         footer#page-footer p a:focus-visible {
            outline: 3px solid var(--focus-outline-color);
         }
         .carousel-button:focus-visible { outline-offset: -4px; }
         .carousel-dot:focus-visible { outline-offset: 3px; }
         #backToTopBtn:focus-visible { outline-offset: 1px; }
         .event-card a:focus-visible { outline-offset: 1px; }
         .contact-button:focus-visible { outline-offset: 1px; }


        /* --- Section Titles --- */
        .section-title {
             font-family: var(--font-heading);
             font-size: 2.5rem;
             text-align: center;
             margin-bottom: 2.5rem;
             position: relative;
             padding-bottom: 0.5rem;
        }
        .section-title::after {
            content: '';
            position: absolute;
            width: 80px;
            height: 3px;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-accent); /* Default */
        }

        /* --- Navigation --- */
        nav {
            background-color: var(--nav-background);
            padding: 0.8rem 1rem;
            position: sticky;
            top: 0;
            z-index: 900;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--card-background);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }

        nav ul li {
            margin: 0 1.0rem; /* Slightly reduced margin */
        }

        nav ul li a {
            color: var(--text-color);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 400;
            padding: 0.5rem 0;
            position: relative;
            transition: color 0.3s ease;
            white-space: nowrap; /* Prevent link text breaking */
        }

        nav ul li a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-accent);
            transition: width 0.3s ease-out;
        }

        nav ul li a:hover,
        nav ul li a.active {
            color: var(--primary-accent);
        }

        nav ul li a:hover::after,
        nav ul li a.active::after {
            width: 100%;
        }


        /* --- Header --- */
        header {
            background: linear-gradient(135deg, var(--primary-accent), var(--secondary-accent));
            padding: 4rem 1rem 5rem 1rem;
            text-align: center;
            clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
            margin-bottom: var(--section-spacing);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: radial-gradient(circle, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 10px 10px;
            opacity: 0.5;
            z-index: 0;
        }


        header h1 {
            font-family: var(--font-heading);
            font-size: 3.8rem;
            color: var(--background-color);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-bottom: 0.75rem;
            position: relative;
            z-index: 1;
            animation: fadeInDown 1s ease-out;
        }

        header p {
            font-size: 1.2rem;
            color: var(--card-background);
            max-width: 650px;
            margin: 0 auto;
            font-weight: 300;
            position: relative;
            z-index: 1;
            animation: fadeInUp 1s ease-out 0.3s;
            animation-fill-mode: backwards;
        }

        /* --- Generic Section Styling & Animations --- */
        .animated-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .animated-section.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Stagger children animation for testimonials and events */
        .animated-section.visible .testimonial-card,
        .animated-section.visible .event-card {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease-out forwards;
        }
        /* Define separate delays if needed, or use a generic counter in JS */
        .animated-section.visible > div > *:nth-child(1) { animation-delay: 0.1s; }
        .animated-section.visible > div > *:nth-child(2) { animation-delay: 0.2s; }
        .animated-section.visible > div > *:nth-child(3) { animation-delay: 0.3s; }
        .animated-section.visible > div > *:nth-child(4) { animation-delay: 0.4s; }
        /* Add more if needed */


        /* --- Gallery Section --- */
        .gallery-container {
            max-width: 1200px;
            margin: var(--section-spacing) auto;
            padding: 0 1rem;
            width: 90%;
            position: relative; /* Needed for observer margin */
        }

        .gallery-title {
             color: var(--secondary-accent);
        }
        .gallery-title::after {
             background-color: var(--secondary-accent);
        }

        /* --- Carousel Styles --- */
        .carousel-container {
            position: relative;
            width: 100%;
            margin: 0 auto;
        }

        .carousel-wrapper {
            overflow: hidden;
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 8px 20px var(--shadow-color);
            cursor: grab; /* Indicate draggable */
        }
        .carousel-wrapper.grabbing {
             cursor: grabbing;
        }

        .carousel-track {
            display: flex;
            transition: transform var(--carousel-transition-speed) ease-in-out;
            aria-live: polite;
            user-select: none;
             -webkit-user-drag: none;
        }

        .carousel-slide {
            flex: 0 0 100%;
            width: 100%;
            background-color: var(--card-background);
            overflow: hidden;
            cursor: pointer;
            position: relative;
            opacity: 0;
            transform: translateX(20px);
            animation: fadeInSlideRight 0.8s ease-out forwards;
            animation-delay: 0.2s;
        }
         .carousel-wrapper.grabbing .carousel-slide {
             cursor: grabbing;
         }

        .carousel-slide img {
            display: block;
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            object-fit: cover;
            transition: transform 0.4s ease-out;
            pointer-events: none;
        }

        .carousel-slide:hover img {
             transform: scale(1.03);
        }

        .carousel-slide .art-info {
            padding: 1.5rem;
            text-align: center;
        }

        .carousel-slide .art-info h3 {
            font-family: var(--font-heading);
            font-size: 1.6rem;
            margin-bottom: 0.6rem;
            color: var(--primary-accent);
        }

        .carousel-slide .art-info p {
            font-size: 0.95rem;
            color: var(--text-color);
            font-weight: 300;
        }

        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
            background-color: rgba(43, 43, 43, 0.7);
            color: var(--text-color);
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(3px);
        }

        .carousel-button:hover {
            background-color: var(--primary-accent);
             color: var(--background-color);
             transform: translateY(-50%) scale(1.1);
        }

        .carousel-button.prev {
            left: 15px;
        }

        .carousel-button.next {
            right: 15px;
        }

        .carousel-button:disabled {
             opacity: 0.4;
             cursor: not-allowed;
             background-color: rgba(43, 43, 43, 0.5);
             transform: translateY(-50%);
        }

        .carousel-dots {
            text-align: center;
            margin-top: 1.5rem;
        }

        .carousel-dot {
            display: inline-block;
            width: 12px;
            height: 12px;
            background-color: var(--card-background);
            border: 1px solid var(--secondary-accent);
            border-radius: 50%;
            margin: 0 6px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
            padding: 0;
            appearance: none;
        }

        .carousel-dot.active {
            background-color: var(--primary-accent);
            transform: scale(1.2);
             border-color: var(--primary-accent);
        }


        /* --- Lightbox --- */
        .lightbox {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.95);
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(8px);
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .lightbox.show {
            opacity: 1;
        }

        .lightbox-content {
            margin: auto;
            display: block;
            max-width: 88%;
            max-height: 88%;
            animation: zoomIn 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
            border-radius: 5px;
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
        }

        .lightbox-caption {
            margin: 20px auto;
            display: block;
            width: 80%;
            max-width: 750px;
            text-align: center;
            color: var(--text-color);
            padding: 10px 0;
            font-size: 1.2rem;
            font-family: var(--font-heading);
            letter-spacing: 1px;
            animation: fadeInUp 0.5s ease-out 0.2s;
            animation-fill-mode: backwards;
        }
        .lightbox-caption strong {
            color: var(--primary-accent);
            display: block;
             margin-bottom: 5px;
        }


        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: var(--text-color);
            font-size: 45px;
            font-weight: bold;
            transition: color 0.3s ease, transform 0.3s ease;
            cursor: pointer;
            line-height: 1;
             text-shadow: 0 0 10px rgba(0,0,0,0.7);
             border: none;
             background: none;
             padding: 0;
        }

        .lightbox-close:hover,
        .lightbox-close:focus-visible {
            color: var(--primary-accent);
            transform: scale(1.1);
            text-decoration: none;
            cursor: pointer;
        }

        /* --- About Section --- */
        #about {
            padding: 50px 1rem;
            max-width: 800px;
            margin: var(--section-spacing) auto;
            background-color: var(--card-background);
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 5px 15px var(--shadow-color);
             position: relative; /* For observer */
        }
        #about h2 {
            color: var(--primary-accent);
        }
         #about h2::after {
            background-color: var(--primary-accent);
        }
        #about p {
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--text-color);
             padding: 0 1rem;
        }

        /* --- Events Section --- */
        #events {
            max-width: 1100px;
            margin: var(--section-spacing) auto;
            padding: 0 1rem;
            position: relative; /* For observer */
        }

        #events .section-title { /* Select title specifically within #events */
            color: var(--tertiary-accent);
        }
        #events .section-title::after {
            background-color: var(--tertiary-accent);
        }

        .events-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .event-card {
            background-color: var(--card-background);
            border-radius: 8px;
            padding: 1.8rem; /* Slightly less padding than testimonials */
            box-shadow: 0 4px 12px var(--shadow-color);
            border-left: 4px solid var(--tertiary-accent);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 18px var(--shadow-color);
        }

        .event-card h3 {
            font-family: var(--font-heading);
            font-size: 1.4rem;
            color: var(--tertiary-accent);
            margin-bottom: 0.7rem;
        }

        .event-card .event-detail {
            font-size: 0.95rem;
            color: var(--text-color);
            margin-bottom: 0.4rem;
            display: flex;
            align-items: center;
            opacity: 0.9;
        }
        .event-card .event-detail svg { /* Style for potential icons */
            width: 16px;
            height: 16px;
            margin-right: 8px;
            fill: var(--secondary-accent); /* Use secondary accent for icons */
            flex-shrink: 0;
        }


        .event-card .event-description {
            font-size: 0.9rem;
            color: var(--text-color);
            font-weight: 300;
            margin-top: 1rem;
            margin-bottom: 1.2rem;
            line-height: 1.6;
        }

        .event-card a {
            display: inline-block;
            font-size: 0.9rem;
            color: var(--secondary-accent);
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease, transform 0.2s ease;
            margin-top: auto; /* Push to bottom if card heights vary */
        }

        .event-card a:hover,
        .event-card a:focus-visible {
            color: var(--primary-accent);
            text-decoration: underline;
            transform: translateX(3px);
        }


        /* --- Testimonials Section --- */
        #testimonials {
            max-width: 1100px;
            margin: var(--section-spacing) auto;
            padding: 0 1rem;
            position: relative; /* For observer */
        }

        #testimonials .section-title { /* Target only testimonials title */
            color: var(--secondary-accent);
        }
         #testimonials .section-title::after {
            background-color: var(--secondary-accent);
        }

        .testimonial-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .testimonial-card {
            background-color: var(--card-background);
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 4px 12px var(--shadow-color);
            border-left: 4px solid var(--primary-accent);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .testimonial-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 18px var(--shadow-color);
        }

        .testimonial-card blockquote {
            font-style: italic;
            color: var(--text-color);
            margin-bottom: 1rem;
            position: relative;
            padding-left: 1.5rem;
            font-size: 1.05rem;
             line-height: 1.7;
        }

        .testimonial-card blockquote::before {
            content: 'â€œ';
            position: absolute;
            left: -5px;
            top: -10px;
            font-size: 3rem;
            color: var(--primary-accent);
            opacity: 0.5;
            font-family: serif;
        }

        .testimonial-card footer {
            text-align: right;
            font-size: 0.95rem;
            font-weight: bold;
            color: var(--secondary-accent);
            margin-top: 1rem;
        }

        .testimonial-card footer span {
            display: block;
            font-weight: 300;
            font-size: 0.85rem;
            color: var(--text-color);
            opacity: 0.8;
            margin-top: 0.2rem;
        }

        /* --- Contact Section --- */
        #contact {
            padding: 50px 1rem;
            text-align: center;
            margin: var(--section-spacing) auto;
            max-width: 800px;
            position: relative; /* For observer */
        }

        #contact .section-title { /* Target only contact title */
            color: var(--primary-accent);
        }
         #contact .section-title::after {
             background-color: var(--primary-accent);
         }

        #contact p {
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--text-color);
            margin-bottom: 1.5rem;
             max-width: 600px;
             margin-left: auto;
             margin-right: auto;
        }
        #contact a.contact-button {
             display: inline-block;
             padding: 12px 25px;
             background-color: var(--primary-accent);
             color: var(--background-color);
             text-decoration: none;
             border-radius: 5px;
             font-weight: bold;
             transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
             box-shadow: 0 3px 8px rgba(255, 107, 107, 0.3);
         }
         #contact a.contact-button:hover,
         #contact a.contact-button:focus-visible {
             background-color: var(--secondary-accent);
             transform: translateY(-2px);
             box-shadow: 0 5px 12px rgba(78, 205, 196, 0.4);
              color: var(--background-color);
         }


        /* --- Footer --- */
        footer#page-footer {
            text-align: center;
            padding: 2.5rem 1rem;
            margin-top: var(--section-spacing);
            font-size: 0.95rem;
            color: rgba(224, 224, 224, 0.7);
            border-top: 1px solid var(--card-background);
            background-color: var(--nav-background);
        }
         footer#page-footer p a {
             color: var(--secondary-accent);
             text-decoration: none;
             transition: color 0.3s ease;
         }
         footer#page-footer p a:hover,
         footer#page-footer p a:focus-visible {
             color: var(--primary-accent);
             text-decoration: underline;
         }

        /* --- Back to Top Button --- */
        #backToTopBtn {
            display: none;
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 990;
            border: none;
            outline: none;
            background-color: var(--primary-accent);
            color: var(--background-color);
            cursor: pointer;
            padding: 0;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            font-size: 20px;
            line-height: 45px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            transition: background-color 0.3s ease, opacity 0.4s ease, transform 0.3s ease;
            opacity: 0;
            transform: translateY(10px);
        }

        #backToTopBtn.show {
            display: block;
            opacity: 0.8;
            transform: translateY(0);
        }

        #backToTopBtn:hover,
        #backToTopBtn:focus-visible {
            background-color: var(--secondary-accent);
            opacity: 1;
            transform: scale(1.1);
            color: var(--background-color);
        }


        /* --- Animations --- */
        @keyframes zoomIn {
            from { transform: scale(0.7); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes fadeInDown {
             from { opacity: 0; transform: translateY(-20px); }
             to { opacity: 1; transform: translateY(0); }
        }
         @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
         }
         @keyframes fadeInSlideRight {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
         }


        /* --- Responsive adjustments --- */
        @media (max-width: 992px) {
            :root { --section-spacing: 3rem; }
            .gallery-container, #about, #events, #testimonials, #contact {
                 width: 95%;
                 max-width: 95%;
            }
             .carousel-slide .art-info h3 { font-size: 1.4rem; }
             .carousel-slide .art-info p { font-size: 0.9rem; }
             .testimonial-container, .events-container { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.2rem; }
             .testimonial-card { padding: 1.5rem; }
             .event-card { padding: 1.5rem; }
             .section-title { font-size: 2.2rem; }
             nav ul li { margin: 0 0.8rem; } /* Adjust nav spacing */
        }

        @media (max-width: 768px) {
             :root { --section-spacing: 2.5rem; }
            nav ul { justify-content: space-around; padding: 0.3rem 0; }
            nav ul li { margin: 0.2rem 0.4rem; }
             nav ul li a { font-size: 0.9rem; }

            header h1 { font-size: 2.8rem; }
             header p { font-size: 1.1rem; }
            header { padding: 3rem 1rem 4rem 1rem; clip-path: polygon(0 0, 100% 0, 100% 90%, 0 100%); }

             .section-title { font-size: 2rem; margin-bottom: 2rem; }
             .carousel-slide .art-info h3 { font-size: 1.3rem; }
            .carousel-button { width: 40px; height: 40px; font-size: 20px; }
             .carousel-button.prev { left: 10px; }
             .carousel-button.next { right: 10px; }

             .testimonial-container, .events-container { grid-template-columns: 1fr; gap: 1rem; }
             .testimonial-card blockquote { font-size: 1rem; }
             .event-card h3 { font-size: 1.3rem; }

             .lightbox-content { max-width: 92%; max-height: 85%; }
             #backToTopBtn {
                bottom: 20px; right: 20px; width: 40px; height: 40px; font-size: 18px; line-height: 40px;
            }
        }

        @media (max-width: 480px) {
             :root { --section-spacing: 2rem; }
             nav { padding: 0.6rem 0.5rem; }
             nav ul { justify-content: center; }
             nav ul li { margin: 0.2rem 0.5rem; }
             nav ul li a { font-size: 0.85rem; padding: 0.4rem 0; }

             header h1 { font-size: 2.2rem; }
             header p { font-size: 1rem; }
             header { padding: 2.5rem 1rem 3.5rem 1rem; }
            .gallery-container, #about, #events, #testimonials, #contact {
                width: 100%; padding: 0 0.5rem;
            }
             .section-title { font-size: 1.8rem; }
             .carousel-wrapper { border-radius: 0; }
             .carousel-slide .art-info h3 { font-size: 1.2rem; }
             .carousel-slide .art-info p { font-size: 0.85rem; }
             .carousel-button { width: 35px; height: 35px; font-size: 18px; }
             .carousel-button.prev { left: 5px; }
             .carousel-button.next { right: 5px; }
              .carousel-dots { margin-top: 1rem; }
             .carousel-dot { width: 10px; height: 10px; margin: 0 4px; }
             .testimonial-card, .event-card { padding: 1.2rem; }
             .testimonial-card blockquote { padding-left: 1rem; }
             .testimonial-card blockquote::before { font-size: 2.5rem; left: -2px; top: -5px; }
             .event-card h3 { font-size: 1.2rem; }
             .event-card .event-detail { font-size: 0.9rem; }
             .event-card .event-description { font-size: 0.85rem; }

            .lightbox-content { max-width: 95%; max-height: 80%; }
             .lightbox-close { top: 15px; right: 20px; font-size: 35px; }
             .lightbox-caption { font-size: 1rem; max-width: 90%; }
            footer#page-footer { padding: 2rem 1rem; margin-top: var(--section-spacing); }
            #backToTopBtn {
                 bottom: 15px; right: 15px; width: 38px; height: 38px; font-size: 16px; line-height: 38px;
             }
        }
    </style>
</head>
<body>

    <nav>
        <ul>
            <li><a href="#home" class="active">Gallery</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#events">Events</a></li> <!-- Added Events Link -->
            <li><a href="#testimonials">Testimonials</a></li>
            <li><a href="#contact">Contact</a></li>
        </ul>
    </nav>

    <header id="home">
        <h1>Ephemeral Visions</h1>
        <p>A Curated Collection of Digital Dreams & Abstract Realities</p>
    </header>

    <main class="gallery-container" id="gallery">
        <h2 class="section-title gallery-title">Featured Works</h2>

        <div class="carousel-container" role="region" aria-roledescription="carousel" aria-label="Featured Artworks">
            <div class="carousel-wrapper">
                <div class="carousel-track" aria-live="polite">
                    <!-- Slides -->
                    <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="1 of 12">
                        <img src="https://source.unsplash.com/random/800x450/?abstract,vibrant" alt="Abstract Vibrant Waves" loading="lazy" data-title="Chromatic Flow" data-description="Digital Painting, 2024">
                        <figcaption class="art-info">
                            <h3>Chromatic Flow</h3>
                            <p>Digital Painting, 2024</p>
                        </figcaption>
                    </figure>

                    <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="2 of 12">
                        <img src="https://source.unsplash.com/random/800x450/?surreal,landscape" alt="Surreal Floating Island" loading="lazy" data-title="Utopia Suspended" data-description="Mixed Media, 2023">
                        <figcaption class="art-info">
                            <h3>Utopia Suspended</h3>
                            <p>Mixed Media, 2023</p>
                        </figcaption>
                    </figure>

                    <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="3 of 12">
                        <img src="https://source.unsplash.com/random/800x450/?galaxy,nebula" alt="Cosmic Nebula" loading="lazy" data-title="Stardust Echoes" data-description="Astrophotography Art, 2024">
                        <figcaption class="art-info">
                            <h3>Stardust Echoes</h3>
                            <p>Astrophotography Art, 2024</p>
                        </figcaption>
                    </figure>

                    <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="4 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?geometric,minimalist" alt="Minimalist Geometric Shapes" loading="lazy" data-title="Order in Chaos" data-description="Generative Art, 2023">
                        <figcaption class="art-info">
                            <h3>Order in Chaos</h3>
                            <p>Generative Art, 2023</p>
                        </figcaption>
                    </figure>

                    <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="5 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?fantasy,forest" alt="Mystical Forest Path" loading="lazy" data-title="Whispering Woods" data-description="Digital Illustration, 2024">
                        <figcaption class="art-info">
                            <h3>Whispering Woods</h3>
                            <p>Digital Illustration, 2024</p>
                        </figcaption>
                    </figure>

                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="6 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?cyberpunk,city" alt="Cyberpunk Cityscape" loading="lazy" data-title="Neon Dreams" data-description="Concept Art, 2023">
                        <figcaption class="art-info">
                            <h3>Neon Dreams</h3>
                            <p>Concept Art, 2023</p>
                        </figcaption>
                    </figure>

                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="7 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?sculpture,modern" alt="Modern Abstract Sculpture" loading="lazy" data-title="Fluid Form" data-description="3D Render, 2024">
                        <figcaption class="art-info">
                            <h3>Fluid Form</h3>
                            <p>3D Render, 2024</p>
                        </figcaption>
                    </figure>

                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="8 of 12">
                        <img src="https://source.unsplash.com/random/800x450/?portrait,colorful" alt="Colorful Abstract Portrait" loading="lazy" data-title="Fractured Identity" data-description="Oil on Canvas (Digitized), 2022">
                        <figcaption class="art-info">
                            <h3>Fractured Identity</h3>
                            <p>Oil on Canvas (Digitized), 2022</p>
                        </figcaption>
                    </figure>

                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="9 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?nature,macro" alt="Macro shot of dew on leaf" loading="lazy" data-title="Emerald Droplets" data-description="Macro Photography, 2024">
                        <figcaption class="art-info">
                            <h3>Emerald Droplets</h3>
                            <p>Macro Photography, 2024</p>
                        </figcaption>
                    </figure>
                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="10 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?architecture,futuristic" alt="Futuristic Building Detail" loading="lazy" data-title="Meta-Structure" data-description="Architectural Render, 2024">
                        <figcaption class="art-info">
                            <h3>Meta-Structure</h3>
                            <p>Architectural Render, 2024</p>
                        </figcaption>
                    </figure>
                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="11 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?water,reflection" alt="City lights reflecting on water" loading="lazy" data-title="Liquid Night" data-description="Long Exposure Photography, 2023">
                        <figcaption class="art-info">
                            <h3>Liquid Night</h3>
                            <p>Long Exposure Photography, 2023</p>
                        </figcaption>
                    </figure>
                     <figure class="carousel-slide" role="group" aria-roledescription="slide" aria-label="12 of 12">
                         <img src="https://source.unsplash.com/random/800x450/?pattern,organic" alt="Organic flowing pattern" loading="lazy" data-title="Bio-Luminescence" data-description="Abstract Digital Art, 2024">
                        <figcaption class="art-info">
                            <h3>Bio-Luminescence</h3>
                            <p>Abstract Digital Art, 2024</p>
                        </figcaption>
                    </figure>
                    <!-- End Slides -->
                </div>
            </div>

            <!-- Navigation Buttons -->
            <button class="carousel-button prev" aria-label="Previous Slide">&#10094;</button>
            <button class="carousel-button next" aria-label="Next Slide">&#10095;</button>

            <!-- Pagination Dots -->
             <div class="carousel-dots"></div>
        </div>

    </main>

    <!-- About section -->
    <section id="about" class="animated-section" aria-labelledby="about-title">
        <h2 class="section-title" id="about-title">About the Artist</h2>
        <p>
            Driven by a passion for the unseen and the imagined, Ephemeral Visions explores the intersection of technology and artistry. Specializing in abstract digital painting, surreal photomanipulation, and generative art, the works aim to evoke emotion and spark curiosity. Each piece is a journey into a unique visual world.
        </p>
    </section>

    <!-- Events Section -->
    <section id="events" class="animated-section" aria-labelledby="events-title">
        <h2 class="section-title" id="events-title">Upcoming Events</h2>
        <div class="events-container">
            <div class="event-card">
                <h3>Exhibition: "Digital Dreams" Opening Night</h3>
                <p class="event-detail">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M13 7h-2v6l5.25 3.15.75-1.23-4.5-2.71V7z"></path></svg>
                    <span>October 15, 2025 | 7:00 PM - 9:00 PM</span>
                </p>
                <p class="event-detail">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C7.589 2 4 5.589 4 10c0 6.5 8 12 8 12s8-5.5 8-12c0-4.411-3.589-8-8-8zm0 12c-2.206 0-4-1.794-4-4s1.794-4 4-4 4 1.794 4 4-1.794 4-4 4z"></path></svg>
                     <span>The Void Gallery, 123 Cyber St.</span>
                </p>
                <p class="event-description">
                    Join us for the opening reception of "Digital Dreams," showcasing the latest works from Ephemeral Visions. Meet the artist and enjoy refreshments.
                </p>
                <a href="#">Learn More</a>
            </div>
            <div class="event-card">
                <h3>Artist Talk: The Process Behind Abstraction</h3>
                 <p class="event-detail">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M13 7h-2v6l5.25 3.15.75-1.23-4.5-2.71V7z"></path></svg>
                    <span>November 5, 2025 | 3:00 PM GMT</span>
                 </p>
                 <p class="event-detail">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="m13 18 6-5-6-5v3H4v4h9z"></path><path d="M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"></path></svg>
                     <span>Online Event (Zoom)</span>
                 </p>
                <p class="event-description">
                    An online session where the artist discusses the techniques and inspirations behind their abstract digital works. Q&A session included.
                </p>
                <a href="#">Register Now</a>
            </div>
             <div class="event-card">
                <h3>Workshop: Introduction to Generative Art</h3>
                 <p class="event-detail">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M13 7h-2v6l5.25 3.15.75-1.23-4.5-2.71V7z"></path></svg>
                    <span>November 20, 2025 | 10:00 AM - 1:00 PM</span>
                 </p>
                 <p class="event-detail">
                     <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C7.589 2 4 5.589 4 10c0 6.5 8 12 8 12s8-5.5 8-12c0-4.411-3.589-8-8-8zm0 12c-2.206 0-4-1.794-4-4s1.794-4 4-4 4 1.794 4 4-1.794 4-4 4z"></path></svg>
                     <span>CodeSpace Hub, 404 Logic Ln.</span>
                 </p>
                <p class="event-description">
                    A hands-on workshop exploring the basics of creating art with code. Suitable for beginners. Limited spots available.
                </p>
                <a href="#">Book Your Place</a>
            </div>
        </div>
    </section>


    <!-- Testimonials Section -->
    <section id="testimonials" class="animated-section" aria-labelledby="testimonials-title">
        <h2 class="section-title" id="testimonials-title">What Clients Say</h2>
        <div class="testimonial-container">
            <div class="testimonial-card">
                <blockquote>
                    The piece we commissioned, 'Chromatic Flow', brings such vibrant energy to our space. The process was seamless and the final artwork exceeded our expectations.
                </blockquote>
                <footer>
                    Alex Johnson
                    <span>Art Collector</span>
                </footer>
            </div>
            <div class="testimonial-card">
                <blockquote>
                    Working with this artist was a fantastic experience. Their unique vision translated beautifully into the 'Utopia Suspended' piece. Truly captivating work!
                </blockquote>
                <footer>
                    Samantha Lee
                    <span>Interior Designer</span>
                </footer>
            </div>
             <div class="testimonial-card">
                <blockquote>
                    I purchased 'Stardust Echoes' for my office. It's a constant source of inspiration and conversation. The quality and depth are remarkable. Highly recommended!
                </blockquote>
                <footer>
                    Dr. Evelyn Reed
                    <span>Astrophysicist</span>
                </footer>
            </div>
             <div class="testimonial-card">
                <blockquote>
                    'Neon Dreams' perfectly captured the futuristic aesthetic I was looking for. The attention to detail and atmosphere is incredible. A true talent.
                </blockquote>
                <footer>
                    Kai Tanaka
                    <span>Game Developer</span>
                </footer>
            </div>
        </div>
    </section>

    <!-- Contact section -->
    <section id="contact" class="animated-section" aria-labelledby="contact-title">
         <h2 class="section-title" id="contact-title">Get In Touch</h2>
        <p>
            For inquiries about available works, commissions, or collaborations, please feel free to reach out. Let's create something unique together.
        </p>
        <a href="mailto:your.email@example.com" class="contact-button">
            Send Email
        </a>
    </section>

    <footer id="page-footer">
        <p>&copy; 2025 Ephemeral Visions. All Rights Reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Use</a></p>
    </footer>

    <!-- Lightbox Structure -->
    <div id="myLightbox" class="lightbox" role="dialog" aria-modal="true" aria-labelledby="lightboxCaptionTitle" aria-describedby="lightboxCaptionDesc">
        <button class="lightbox-close" aria-label="Close lightbox">&times;</button>
        <img class="lightbox-content" id="lightboxImg" alt="Enlarged artwork">
        <div class="lightbox-caption" id="caption">
            <strong id="lightboxCaptionTitle"></strong><span id="lightboxCaptionDesc"></span>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button id="backToTopBtn" title="Go to top" aria-label="Scroll back to top">&#8679;</button>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lightbox = document.getElementById('myLightbox');
            const lightboxImg = document.getElementById('lightboxImg');
            const captionContainer = document.getElementById('caption');
            const captionTitle = document.getElementById('lightboxCaptionTitle');
            const captionDesc = document.getElementById('lightboxCaptionDesc');
            const closeBtn = document.querySelector('.lightbox-close');
            const galleryImages = document.querySelectorAll('.carousel-slide img');
            const navLinks = document.querySelectorAll('nav a');
            const backToTopButton = document.getElementById("backToTopBtn");
            // Updated selector to include the new #events section
            const sections = document.querySelectorAll('section[id], header[id]');
            const animatedSections = document.querySelectorAll('.animated-section');

            // --- Carousel Functionality ---
            const carouselContainer = document.querySelector('.carousel-container');
            const track = document.querySelector('.carousel-track');
            const wrapper = document.querySelector('.carousel-wrapper');
            const slides = Array.from(track.children);
            const nextButton = document.querySelector('.carousel-button.next');
            const prevButton = document.querySelector('.carousel-button.prev');
            const dotsNav = document.querySelector('.carousel-dots');

            let slideWidth = 0;
            let currentIndex = 0;
            let isDragging = false;
            let startPos = 0;
            let currentTranslate = 0;
            let prevTranslate = 0;
            let animationID;
            let autoplayInterval = null;
            const autoplayDelay = 5000;

            function setSlidePosition(moveInstantly = true) {
                if (slides.length === 0) return;
                const wasDragging = isDragging;
                isDragging = false;

                slideWidth = wrapper.clientWidth;
                if (!slideWidth) return; // Avoid errors if wrapper has no width yet

                slides.forEach((slide, index) => {
                    slide.style.width = `${slideWidth}px`;
                    slide.setAttribute('aria-label', `${index + 1} of ${slides.length}`);
                });
                track.style.width = `${slideWidth * slides.length}px`;

                currentTranslate = currentIndex * -slideWidth;
                prevTranslate = currentTranslate;

                 if (moveInstantly) {
                    track.style.transition = 'none';
                    track.style.transform = `translateX(${currentTranslate}px)`;
                     void track.offsetWidth;
                    track.style.transition = `transform var(--carousel-transition-speed) ease-in-out`;
                 } else {
                     track.style.transform = `translateX(${currentTranslate}px)`;
                 }

                 updateNavControls();
                 if (wasDragging) wrapper.classList.remove('grabbing');
            }

            if (dotsNav && slides.length > 0) {
                 dotsNav.innerHTML = '';
                 slides.forEach((_, index) => {
                     const button = document.createElement('button');
                     button.classList.add('carousel-dot');
                     button.setAttribute('aria-label', `Go to slide ${index + 1}`);
                     dotsNav.appendChild(button);
                 });
                 dotsNav.children[currentIndex]?.classList.add('active');

                 dotsNav.addEventListener('click', e => {
                      if (!e.target.matches('button.carousel-dot')) return;
                      const targetIndex = Array.from(dotsNav.children).findIndex(dot => dot === e.target);
                      if(targetIndex !== -1) {
                          moveToSlide(targetIndex);
                          resetAutoplay();
                      }
                 });
             }
            const dots = dotsNav ? Array.from(dotsNav.children) : [];

            const moveToSlide = (targetIndex) => {
                if (targetIndex < 0 || targetIndex >= slides.length || !slideWidth) return;

                track.style.transition = `transform var(--carousel-transition-speed) ease-in-out`;
                currentTranslate = targetIndex * -slideWidth;
                track.style.transform = `translateX(${currentTranslate}px)`;
                prevTranslate = currentTranslate;
                currentIndex = targetIndex;

                updateNavControls();
            }

            const updateNavControls = () => {
                if (prevButton && nextButton) {
                    prevButton.disabled = currentIndex === 0;
                    nextButton.disabled = currentIndex === slides.length - 1;
                }
                if (dots.length > 0) {
                    dots.forEach(dot => dot.classList.remove('active'));
                    dots[currentIndex]?.classList.add('active');
                }
            }

            function startAutoplay() {
                stopAutoplay();
                if (slides.length <= 1) return;

                autoplayInterval = setInterval(() => {
                    const nextIndex = (currentIndex + 1) % slides.length;
                    moveToSlide(nextIndex);
                }, autoplayDelay);
            }

            function stopAutoplay() {
                clearInterval(autoplayInterval);
                autoplayInterval = null;
            }

            function resetAutoplay() {
                 stopAutoplay();
                 startAutoplay();
             }

             carouselContainer?.addEventListener('mouseenter', stopAutoplay);
             carouselContainer?.addEventListener('focusin', stopAutoplay);
             carouselContainer?.addEventListener('mouseleave', startAutoplay);
             carouselContainer?.addEventListener('focusout', startAutoplay);

            function touchStart(index) {
                return function(event) {
                    stopAutoplay();
                    currentIndex = index;
                    startPos = getPositionX(event);
                    isDragging = true;
                    animationID = requestAnimationFrame(animation);
                    wrapper.classList.add('grabbing');
                    track.style.transition = 'none';
                }
            }

            function touchEnd(event) {
                if (!isDragging) return;
                 isDragging = false;
                 cancelAnimationFrame(animationID);

                 const movedBy = currentTranslate - prevTranslate;

                 if (movedBy < -50 && currentIndex < slides.length - 1) {
                     currentIndex += 1;
                 }
                 if (movedBy > 50 && currentIndex > 0) {
                     currentIndex -= 1;
                 }

                 setSlidePosition(false);
                 wrapper.classList.remove('grabbing');
                 startAutoplay();
            }

            function touchMove(event) {
                 if (isDragging) {
                     const currentPosition = getPositionX(event);
                     currentTranslate = prevTranslate + currentPosition - startPos;
                 }
            }

            function getPositionX(event) {
                return event.type.includes('mouse') ? event.pageX : event.touches[0].clientX;
            }

            function animation() {
                track.style.transform = `translateX(${currentTranslate}px)`;
                if (isDragging) requestAnimationFrame(animation);
            }

            slides.forEach((slide, index) => {
                const slideImage = slide.querySelector('img');
                slideImage?.addEventListener('dragstart', (e) => e.preventDefault());
                slide.addEventListener('touchstart', touchStart(index), { passive: true });
                 slide.addEventListener('mousedown', touchStart(index));
            });

             wrapper?.addEventListener('touchmove', touchMove, { passive: true });
             wrapper?.addEventListener('touchend', touchEnd);
             wrapper?.addEventListener('mouseleave', touchEnd);
             wrapper?.addEventListener('mousemove', touchMove);
             wrapper?.addEventListener('mouseup', touchEnd);

            nextButton?.addEventListener('click', () => {
                moveToSlide(currentIndex + 1);
                resetAutoplay();
            });

            prevButton?.addEventListener('click', () => {
                moveToSlide(currentIndex - 1);
                resetAutoplay();
            });

             let resizeTimeout;
            window.addEventListener('resize', () => {
                 clearTimeout(resizeTimeout);
                 resizeTimeout = setTimeout(() => {
                     setSlidePosition(true);
                 }, 150);
             });

            // Initial setup only if carousel exists
            if (track && wrapper && slides.length > 0) {
                setSlidePosition(true);
                startAutoplay();
            }


            // --- Lightbox Functionality ---
            galleryImages.forEach(item => {
                const parentSlide = item.closest('.carousel-slide');
                parentSlide?.addEventListener('click', (e) => {
                    // Check if the click target is not a button/dot and not during drag
                    if (!isDragging && e.target !== prevButton && e.target !== nextButton && !e.target.closest('.carousel-button') && !e.target.closest('.carousel-dots')) {
                        lightbox.style.display = 'flex';
                         requestAnimationFrame(() => {
                            lightbox.classList.add('show');
                         });
                        lightboxImg.src = item.src;
                        lightboxImg.alt = item.alt;
                        const title = item.getAttribute('data-title') || 'Artwork';
                        const description = item.getAttribute('data-description') || '';
                        captionTitle.textContent = title;
                        captionDesc.textContent = description ? ` ${description}` : '';

                        document.body.style.overflow = 'hidden';
                         stopAutoplay(); // Stop carousel autoplay
                         closeBtn.focus();
                    }
                });
            });

            function closeLightbox() {
                lightbox.classList.remove('show');
                 lightbox.addEventListener('transitionend', (e) => {
                     if (e.propertyName === 'opacity' && !lightbox.classList.contains('show')) {
                         lightbox.style.display = 'none';
                         document.body.style.overflow = 'auto';
                         // Attempt to focus the slide that opened the lightbox (might need refinement)
                         const activeSlide = document.querySelector(`.carousel-slide[aria-label="${currentIndex + 1} of ${slides.length}"]`);
                         activeSlide?.focus();
                     }
                 }, { once: true });
                 startAutoplay(); // Resume carousel autoplay
            }

            closeBtn?.addEventListener('click', closeLightbox);

            lightbox?.addEventListener('click', (event) => {
                if (event.target === lightbox) {
                    closeLightbox();
                }
            });

            document.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && lightbox?.style.display === 'flex') {
                    closeLightbox();
                }
            });

             // --- Nav Link Click Handling & Active State ---
             navLinks.forEach(link => {
                 link.addEventListener('click', (e) => {
                    const targetId = e.currentTarget.getAttribute('href');
                    if (targetId && targetId.startsWith('#')) {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            e.preventDefault(); // Prevent default anchor jump
                            navLinks.forEach(node => node.classList.remove('active'));
                            e.currentTarget.classList.add('active');
                            // Calculate offset for sticky nav
                            const navHeight = document.querySelector('nav')?.offsetHeight || 0;
                            const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
                            const offsetPosition = elementPosition - navHeight - 10; // 10px buffer

                            window.scrollTo({
                                top: offsetPosition,
                                behavior: 'smooth'
                            });
                        }
                    }
                 });
             });

            // --- Back to Top Button Functionality ---
            const scrollFunction = () => {
                if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
                    if (!backToTopButton.classList.contains("show")) {
                        backToTopButton.style.display = 'block';
                        requestAnimationFrame(() => { backToTopButton.classList.add("show"); });
                    }
                } else {
                    if (backToTopButton.classList.contains("show")) {
                        backToTopButton.classList.remove("show");
                         backToTopButton.addEventListener('transitionend', (e) => {
                             if (e.propertyName === 'opacity' && !backToTopButton.classList.contains("show")) {
                                 backToTopButton.style.display = 'none';
                             }
                         }, { once: true });
                    }
                }
            };

            window.addEventListener('scroll', scrollFunction);

            backToTopButton?.addEventListener("click", () => {
                window.scrollTo({top: 0, behavior: 'smooth'});
                 // Update active nav link after scrolling
                 setTimeout(() => {
                     navLinks.forEach(node => node.classList.remove('active'));
                     document.querySelector('nav a[href="#home"]')?.classList.add('active');
                 }, 500); // Delay to allow scroll to finish roughly
            });


            // --- Highlight Nav Link on Scroll ---
             const navObserverOptions = {
                root: null,
                // Adjust rootMargin: top margin is negative nav height + threshold, bottom is negative viewport height + threshold
                rootMargin: `-${(document.querySelector('nav')?.offsetHeight || 60) + 50}px 0px -${window.innerHeight - (document.querySelector('nav')?.offsetHeight || 60) - 100}px 0px`,
                 threshold: 0 // Trigger as soon as element enters/leaves margin area
             };

             const navObserverCallback = (entries) => {
                 entries.forEach(entry => {
                     const id = entry.target.getAttribute('id');
                     const navLink = document.querySelector(`nav a[href="#${id}"]`);

                     if (entry.isIntersecting && navLink) {
                         navLinks.forEach(link => link.classList.remove('active'));
                         navLink.classList.add('active');
                     }
                 });
             };

             const navObserver = new IntersectionObserver(navObserverCallback, navObserverOptions);
             sections.forEach(section => {
                if(section.id) navObserver.observe(section);
             });

            // --- Scroll Animations for Sections ---
             const sectionObserverOptions = {
                 root: null,
                 rootMargin: '0px 0px -100px 0px',
                 threshold: 0.1
             };

             const sectionObserverCallback = (entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        // Apply stagger delay to children if applicable
                        const cards = entry.target.querySelectorAll('.testimonial-card, .event-card');
                        cards.forEach((card, index) => {
                            card.style.animationDelay = `${index * 0.1}s`; // Apply inline delay
                        });
                        observer.unobserve(entry.target);
                    }
                });
             };

             const sectionObserver = new IntersectionObserver(sectionObserverCallback, sectionObserverOptions);

             animatedSections.forEach(section => {
                 sectionObserver.observe(section);
             });


        }); // End DOMContentLoaded
    </script>

</body>
</html>
```